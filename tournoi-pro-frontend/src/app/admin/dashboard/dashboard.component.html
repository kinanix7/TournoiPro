<app-navigation></app-navigation>

<div class="container-fluid py-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h2 mb-0">
          <i class="bi bi-speedometer2 me-2"></i>Admin Dashboard
        </h1>
        <button 
          type="button" 
          class="btn btn-outline-primary"
          (click)="refreshData()">
          <i class="bi bi-arrow-clockwise me-1"></i>Refresh Data
        </button>
      </div>
    </div>
  </div>
  
  <!-- Statistics Cards -->
  <div class="row mb-4">
    <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
      <div class="card stat-card bg-primary text-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-title mb-1">Players</h6>
              <h3 class="mb-0">{{ statistics.players }}</h3>
              <small class="opacity-75">Total registered</small>
            </div>
            <div class="stat-icon">
              <i class="bi bi-person-fill fs-2 opacity-75"></i>
            </div>
          </div>
        </div>
        <div class="card-footer bg-dark bg-opacity-10 border-0">
          <a routerLink="/admin/players" class="text-white text-decoration-none">
            <small><i class="bi bi-arrow-right me-1"></i>Manage Players</small>
          </a>
        </div>
      </div>
    </div>
    
    <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
      <div class="card stat-card bg-success text-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-title mb-1">Teams</h6>
              <h3 class="mb-0">{{ statistics.teams }}</h3>
              <small class="opacity-75">Active teams</small>
            </div>
            <div class="stat-icon">
              <i class="bi bi-people-fill fs-2 opacity-75"></i>
            </div>
          </div>
        </div>
        <div class="card-footer bg-dark bg-opacity-10 border-0">
          <a routerLink="/admin/teams" class="text-white text-decoration-none">
            <small><i class="bi bi-arrow-right me-1"></i>Manage Teams</small>
          </a>
        </div>
      </div>
    </div>
    
    <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
      <div class="card stat-card bg-warning text-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-title mb-1">Matches</h6>
              <h3 class="mb-0">{{ statistics.matches }}</h3>
              <small class="opacity-75">Total scheduled</small>
            </div>
            <div class="stat-icon">
              <i class="bi bi-calendar-event-fill fs-2 opacity-75"></i>
            </div>
          </div>
        </div>
        <div class="card-footer bg-dark bg-opacity-10 border-0">
          <a routerLink="/admin/matches" class="text-white text-decoration-none">
            <small><i class="bi bi-arrow-right me-1"></i>Manage Matches</small>
          </a>
        </div>
      </div>
    </div>
    
    <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
      <div class="card stat-card bg-info text-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-title mb-1">Referees</h6>
              <h3 class="mb-0">{{ statistics.referees }}</h3>
              <small class="opacity-75">Available refs</small>
            </div>
            <div class="stat-icon">
              <i class="bi bi-person-badge-fill fs-2 opacity-75"></i>
            </div>
          </div>
        </div>
        <div class="card-footer bg-dark bg-opacity-10 border-0">
          <a routerLink="/admin/referees" class="text-white text-decoration-none">
            <small><i class="bi bi-arrow-right me-1"></i>Manage Referees</small>
          </a>
        </div>
      </div>
    </div>
    
    <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
      <div class="card stat-card bg-danger text-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-title mb-1">Courts</h6>
              <h3 class="mb-0">{{ statistics.courts }}</h3>
              <small class="opacity-75">Available courts</small>
            </div>
            <div class="stat-icon">
              <i class="bi bi-geo-alt-fill fs-2 opacity-75"></i>
            </div>
          </div>
        </div>
        <div class="card-footer bg-dark bg-opacity-10 border-0">
          <a routerLink="/admin/courts" class="text-white text-decoration-none">
            <small><i class="bi bi-arrow-right me-1"></i>Manage Courts</small>
          </a>
        </div>
      </div>
    </div>
    
    <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
      <div class="card stat-card bg-secondary text-white h-100">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h6 class="card-title mb-1">Completed</h6>
              <h3 class="mb-0">{{ completionRate }}%</h3>
              <small class="opacity-75">Match completion</small>
            </div>
            <div class="stat-icon">
              <i class="bi bi-check-circle-fill fs-2 opacity-75"></i>
            </div>
          </div>
        </div>
        <div class="card-footer bg-dark bg-opacity-10 border-0">
            <small><i class="bi bi-arrow-right me-1"></i>Pool Generation</small>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Quick Actions -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-lightning-fill me-2"></i>Quick Actions
          </h5>
        </div>
        <div class="card-body">
          <div class="row g-3">
            <div class="col-md-3">
              <a routerLink="/admin/players" class="btn btn-outline-primary w-100 h-100 d-flex flex-column justify-content-center">
                <i class="bi bi-person-plus fs-2 mb-2"></i>
                <span>Add Player</span>
              </a>
            </div>
            <div class="col-md-3">
              <a routerLink="/admin/teams" class="btn btn-outline-success w-100 h-100 d-flex flex-column justify-content-center">
                <i class="bi bi-people fs-2 mb-2"></i>
                <span>Create Team</span>
              </a>
            </div>
            <div class="col-md-3">
              <a routerLink="/admin/matches" class="btn btn-outline-warning w-100 h-100 d-flex flex-column justify-content-center">
                <i class="bi bi-calendar-plus fs-2 mb-2"></i>
                <span>Schedule Match</span>
              </a>
            </div>
            <div class="col-md-3">
              <button class="btn btn-outline-info w-100 h-100 d-flex flex-column justify-content-center" disabled>
                <i class="bi bi-diagram-3 fs-2 mb-2"></i>
                <span>Generate Pools</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Recent Activity & System Status -->
  <div class="row">
    <div class="col-lg-8">
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="mb-0">
            <i class="bi bi-activity me-2"></i>System Overview
          </h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <h6 class="text-muted">Tournament Progress</h6>
              <div class="progress mb-3" style="height: 10px;">
                <div class="progress-bar bg-success" 
                     [style.width.%]="completionRate"
                     role="progressbar">
                </div>
              </div>
              <small class="text-muted">{{ completionRate }}% of matches completed</small>
            </div>
            <div class="col-md-6">
              <h6 class="text-muted">Team Formation</h6>
              <div class="progress mb-3" style="height: 10px;">
                <div class="progress-bar bg-info" 
                     [style.width.%]="teamFormationRate"
                     role="progressbar">
                </div>
              </div>
              <small class="text-muted">{{ teamFormationRate }}% of players assigned to teams</small>
            </div>
          </div>
          
          <hr class="my-4">
          
          <div class="row text-center">
            <div class="col-md-3">
              <div class="metric">
                <h4 class="text-primary">{{ statistics.players }}</h4>
                <small class="text-muted">Total Players</small>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric">
                <h4 class="text-success">{{ statistics.teams }}</h4>
                <small class="text-muted">Active Teams</small>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric">
                <h4 class="text-warning">{{ pendingMatches }}</h4>
                <small class="text-muted">Pending Matches</small>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric">
                <h4 class="text-info">{{ completedMatches }}</h4>
                <small class="text-muted">Completed Matches</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-4">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-exclamation-triangle me-2"></i>Alerts & Warnings
          </h5>
        </div>
        <div class="card-body">
          <div *ngIf="alerts.length === 0" class="text-center text-muted py-3">
            <i class="bi bi-check-circle fs-2 d-block mb-2 text-success"></i>
            <p class="mb-0">All systems running smoothly!</p>
          </div>
          
          <div *ngFor="let alert of alerts" class="alert" [class]="'alert-' + alert.type" role="alert">
            <div class="d-flex align-items-center">
              <i class="bi" [class]="alert.icon + ' me-2'"></i>
              <div>
                <strong>{{ alert.title }}</strong><br>
                <small>{{ alert.message }}</small>
              </div>
            </div>
          </div>
          
          <div class="d-grid gap-2">
            <button class="btn btn-outline-secondary btn-sm" (click)="checkSystemHealth()">
              <i class="bi bi-shield-check me-1"></i>Run System Check
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>